<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveLink - 데이트 컨텐츠</title>
    <style th:inline="css">
        /* 전체 페이지 기본 스타일 */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }

        /* 배경 이미지 스타일 */
        #bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -3;
        }

        /* 헤더와 푸터 이미지 스타일 */
        #header, #footer {
            position: fixed;
            left: 0;
            width: 100%;
            z-index: -2;
        }
        #header { top: 0; }
        #footer { bottom: 0; }

        /* 로고 이미지 스타일 */
        #logo, #text-logo {
            position: fixed;
            z-index: 1;
        }
        #logo {
            top: 20px;
            left: 20px;
            width: 100px; /* 적절한 크기로 조정 */
        }
        #text-logo {
            top: 20px;
            left: 140px; /* 로고 옆에 위치 */
            width: 150px; /* 적절한 크기로 조정 */
        }

        /* 메인 컨텐츠 영역 */
        main {
            position: relative;
            z-index: 1;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* 컨텐츠 컨테이너 */
        .content-container {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 1000px;
            text-align: center;
        }

        /* 네비게이션 버튼 스타일 */
        .nav-buttons {
            margin-bottom: 20px;
        }
        .nav-btn {
            margin: 0 10px;
            padding: 10px 20px;
            background-color: #ff69b4;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* 검색 영역 스타일 */
        .search-container {
            margin-bottom: 20px;
        }
        #location-search {
            padding: 10px;
            width: 60%;
            margin-right: 10px;
        }
        #nearby-btn {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* 카테고리 버튼 스타일 */
        .category-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        .category-btn {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* 컨텐츠 리스트 스타일 */
        .content-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        .content-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .content-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 5px;
        }
    </style>
</head>
<body>
<!-- 배경, 헤더, 푸터 이미지 -->
<img th:src="@{..static/image/BG.svg}" alt="Background" id="bg">
<img th:src="@{..static/image/header.svg}" alt="Header" id="header">
<img th:src="@{..static/image/footer.svg}" alt="Footer" id="footer">

<!-- 로고 이미지 -->
<img th:src="@{..static/image/char-logo.svg}" alt="Logo" id="logo">
<img th:src="@{..static/image/lovelink-logo.svg}" alt="LoveLink Logo" id="text-logo">

<!-- 메인 컨텐츠 영역 -->
<main>
    <div class="content-container">
        <div class="nav-buttons">
            <button class="nav-btn" th:each="navItem : ${navItems}" th:text="${navItem}">네비게이션 항목</button>
        </div>

        <h2 th:text="${pageTitle}">우리 오늘 뭐할까?</h2>

        <div class="search-container">
            <input type="text" id="location-search" th:placeholder="${searchPlaceholder}">
            <button id="nearby-btn" th:text="${nearbyButtonText}">내주변</button>
        </div>

        <div class="category-buttons">
            <button class="category-btn" th:each="category : ${categories}"
                    th:data-category="${category.key}" th:text="${category.value}">카테고리</button>
        </div>

        <div class="content-list">
            <!-- Thymeleaf를 사용한 동적 컨텐츠 생성 -->
            <div class="content-item" th:each="item : ${contentItems}">
                <img th:src="${item.image}" th:alt="${item.name}">
                <h3 th:text="${item.name}">컨텐츠 이름</h3>
                <p th:text="'평점: ' + ${item.rating}">평점: 0.0</p>
            </div>
        </div>
    </div>
</main>

<script th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener('DOMContentLoaded', function() {
        // DOM 요소 선택
        const categoryButtons = document.querySelectorAll('.category-btn');
        const contentList = document.querySelector('.content-list');
        const locationSearch = document.getElementById('location-search');
        const nearbyBtn = document.getElementById('nearby-btn');

        // 카테고리 버튼 이벤트 리스너
        categoryButtons.forEach(button => {
            button.addEventListener('click', function() {
                const category = this.dataset.category;
                fetchContents(category);
            });
        });

        // 컨텐츠 가져오기 함수 (API 호출)
        async function fetchContents(category) {
            try {
                const response = await fetch(`/api/contents?category=${category}`);
                if (!response.ok) {
                    throw new Error('API 호출 실패');
                }
                const data = await response.json();
                displayContents(data);
            } catch (error) {
                console.error('컨텐츠 가져오기 오류:', error);
                contentList.innerHTML = '<p>컨텐츠를 불러오는 데 실패했습니다. 다시 시도해주세요.</p>';
            }
        }

        // 컨텐츠 표시 함수
        function displayContents(data) {
            contentList.innerHTML = '';
            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'content-item';
                div.innerHTML = `
                        <img src="${item.image}" alt="${item.name}">
                        <h3>${item.name}</h3>
                        <p>평점: ${item.rating}</p>
                    `;
                contentList.appendChild(div);
            });
        }

        // 지역 검색 이벤트 리스너
        locationSearch.addEventListener('input', debounce(function() {
            searchByLocation(this.value);
        }, 300));

        // 내 주변 버튼 이벤트 리스너
        nearbyBtn.addEventListener('click', function() {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(position => {
                    const { latitude, longitude } = position.coords;
                    searchNearby(latitude, longitude);
                }, error => {
                    console.error('위치 정보 가져오기 실패:', error);
                    alert('위치 정보를 가져올 수 없습니다. 위치 서비스를 활성화해주세요.');
                });
            } else {
                alert('이 브라우저에서는 위치 서비스를 지원하지 않습니다.');
            }
        });

        // 지역 검색 함수
        async function searchByLocation(query) {
            // API 호출 및 결과 표시 로직
        }

        // 주변 검색 함수
        async function searchNearby(latitude, longitude) {
            // API 호출 및 결과 표시 로직
        }

        // 디바운스 함수
        function debounce(func, delay) {
            let timeoutId;
            return function (...args) {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => func.apply(this, args), delay);
            };
        }
    });
    /*]]>*/
</script>
</body>
</html>